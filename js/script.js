const videos=document.querySelectorAll(".video"),secondsDelay=[3.9,"finish","finish",1.7,10.7,19.7,28.7,37.7,46.7,55.7,64.7,73.7,82.7,91.7,"finish",5.1,"repeat"],modal=document.querySelector(".modal");let clickCount=0,videoCount=1,canClick=!1,currentVideo=Array.from(videos).filter(e=>"video-1"===e.id)[0],hintIcon=document.querySelector(".hint-icon"),showModalTimer,restartTimer;function playVideo(){"video-3"!==currentVideo.id||hintIcon.classList.contains("hidden")||hintIcon.classList.add("hidden"),canClick=!1,currentVideo.play(),handleTimeUpdate()}for(let video of(document.addEventListener("DOMContentLoaded",()=>{playVideo()}),videos))video.addEventListener("ended",function(){currentVideo.classList.add("hidden"),++videoCount,++clickCount,videoCount>4?restart():((currentVideo=Array.from(videos).filter(e=>e.id===`video-${videoCount}`)[0]).classList.remove("hidden"),playVideo())});function handleTimeUpdate(){let e=setInterval(()=>{(currentVideo.currentTime.toFixed(1)==secondsDelay[clickCount]||currentVideo.currentTime.toFixed(1)==secondsDelay[clickCount]+.1||currentVideo.currentTime.toFixed(1)==secondsDelay[clickCount]-.1)&&(currentVideo.pause(),"video-3"===currentVideo.id&&hintIcon.classList.remove("hidden"),canClick=!0,clearInterval(e),enableInactionModal())},100)}function restart(){currentVideo.classList.add("hidden"),currentVideo.currentTime=0,(currentVideo=Array.from(videos).filter(e=>"video-1"===e.id)[0]).classList.remove("hidden"),videoCount=1,clickCount=0,hintIcon.classList.contains("hidden")||hintIcon.classList.add("hidden"),playVideo()}function enableInactionModal(){("video-3"===currentVideo.id||"video-4"===currentVideo.id)&&(showModalTimer&&clearTimeout(showModalTimer),restartTimer&&clearTimeout(restartTimer),showModalTimer=setTimeout(()=>{modal.classList.remove("hidden"),restartTimer=setTimeout(()=>{modal.classList.contains("hidden")||(restart(),modal.classList.add("hidden"))},1e4)},4e4))}function disableInactionModal(){("video-3"===currentVideo.id||"video-4"===currentVideo.id)&&(showModalTimer&&clearTimeout(showModalTimer),restartTimer&&clearTimeout(restartTimer),modal.classList.add("hidden"))}document.addEventListener("click",()=>{canClick&&(modal.classList.contains("hidden")?(++clickCount,playVideo(),showModalTimer&&(clearTimeout(showModalTimer),showModalTimer=null),restartTimer&&(clearTimeout(restartTimer),restartTimer=null)):(disableInactionModal(),enableInactionModal()))});